# 脚本摘要

维护人：杨健桦

创建时间：2023.01.31

更新时间：



1. 安装gitlab二进制


# 入参说明

| 参数     | 参数名称     | 类型   | 必填 | 默认值    | 备注                 |
| -------- | ------------ | ------ | ---- | --------- | -------------------- |
| rootdir     | 组件安装目录 | 字符串 | 否   | /sie/gitlab/ |  组件安装目录定义                    |
| datadir     | 数据目录 | 字符串 | 否   | /sie/gitlab/data | 数据存储目录定义                    |
| backupdir | 备份目录 | 字符串 | 否 | /sie/gitlab/backup |  |
| cronstr | 备份策略 | 字符串 | 否 | * * 4 * * * |  |
| host     | 需要安装主机地址 | 字符串 | 否   | 127.0.0.1 |    默认127.0.0.1                  |
| port     | 定义服务端口  | 数值   | 否   | 8080        |    默认8080                  |
| passwd     | 初始访问密码     | 字符串   | 是   | xxxxx         | 初始访问密码定义 |
| email | 邮件发送地址     | 字符串 | 是   | xxxxx@email.com          | 初始登陆邮箱定义       |
| unstall | 卸载已安装     | 数值 | 否   | 0          | 0=不生效；1=生效       |






# 返回值说明

``` shell

result：0 # 0=执行成功；1=不成功；
message：succeed # 执行成功
IP: 127.0.0.1 # 服务所在服务器地址
Port：8080 # 服务所使用端口
passwd：xxxxxx # 初始登陆密码
email: xxxx@email.com # 初始登陆邮箱

```



# 脚本示例

``` shell
./run.sh --host=127.0.0.1 --port=8080  --passwd=xxxxx --email=xxxxxx@email.com
```



# 脚本逻辑

1. 检查rootdir是否存在，不存在创建文件夹；
2. 检查datadir是否存在，不存在创建文件夹；
3. 安装gitlab服务；
4. 配置gitlab服务自启动；
5. 配置gitlab服务守护进程；
6. 更改默认gitlab配置文件；
7. 定义服务安装主机所在IP；
8. 定义服务安装主机所使用端口；
9. 定义gitlab初始化邮箱账号跟密码；
10. 启用gitlab服务；
11. 检查安装包是否存在目标文件夹；
12. 输出安装过程信息；
13. 输出gitlab服务版本；